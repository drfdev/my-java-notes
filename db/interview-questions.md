### Data Base interview questions

---

ACID

* A — Атомарность (Atomicity). 
  Гарантирует, что никакая транзакция не будет зафиксирована в системе частично.
* C — Согласованность (Consistency).
  Каждая успешная транзакция фиксирует только допустимые результаты.
* I — Изолированность (Isolation).
  Во время выполнения транзакции параллельные транзакции не должны оказывать влияния на её результат.
* D — Стойкость (Durability).
  Подтверждённые изменения не будут отменены (например, из-за сбоя).


---

Уровни изолированности:

* Read uncommitted (чтение незафиксированных данных).
  Он гарантирует только отсутствие потерянных обновлений (ситуация, когда при одновременном изменении одного блока данных
  разными транзакциями одно из изменений теряется).
* Read committed (чтение фиксированных данных).
  Именно он чаще всего является уровнем по умолчанию. Обеспечивает защиту от «грязного» чтения
  (чтение данных, добавленных или изменённых транзакцией, которая впоследствии откатится).
* Repeatable read (повторяемость чтения).
  Решает проблему неповторяющегося чтения (ситуация, когда при повторном чтении в рамках одной
  транзакции ранее прочитанные данные оказываются изменёнными).
* Serializable (упорядочиваемость).
  Транзакции полностью изолируются друг от друга, каждая выполняется так, как будто параллельных
  транзакций не существует — защищает от фантомного чтения (ситуация, когда при повторном чтении
  в рамках одной транзакции одна и та же выборка дает разные множества строк).

Info:
- https://habr.com/ru/articles/469415/

---

Индексы

Это структура данных, которая повышает скорость операций поиска данных в таблице БД
за счет дополнительных операций записи и хранения для поддержания структуры данных индекса

Ключом индекса выступает значение индексируемого столбца/столбцов.
Некоторые БД позволяют строить индексы по выражениям.

Типы индексов:
- Упорядоченные — индексы, в которых записи упорядочены по возрастанию или убыванию. Реализуются на B-деревьях.
- Неупорядоченные — индексы, в которых записи неупорядоченны. Реализуются на хешах. 

Или по воздействию на источник данных:
- Некластерные — такие индексы организуют ссылки на соответствующие строки и значения.
  Ссылка содержит информацию об ID файла, в котором хранится строка;
  ID страницы соответствующих данных; номер искомой строки на соответствующей странице; содержимое столбца.
  В таблице БД может быть несколько некластерных индексов.
- Кластерные — такие индексы представляют собой древовидную структуру данных, 
  при которой значения индекса хранятся вместе с соответствующими им данными.
  Физическое расположение данных перестраивается в соответствии с порядком индекса,
  поэтому может быть только один такой индекс на таблицу БД.

Структуры данных для построения идексов:
* B-Tree: https://en.wikipedia.org/wiki/B-tree
* HASH-таблицы: https://en.wikipedia.org/wiki/Hash_table
* Bitmap: http://citforum.ru/database/oracle/bitmap_index/
* Фильтр Блума: https://en.wikipedia.org/wiki/Bloom_filter
* Spatial grid: https://en.wikipedia.org/wiki/Grid_(spatial_index)
* Quadtree: https://en.wikipedia.org/wiki/Quadtree
* R-Tree: https://en.wikipedia.org/wiki/Hilbert_R-tree


---

Блокировки

1) Оптимистическая
   не ограничивает модификацию данных сторонними транзакциями. Перед записью проверяется значение какого-нибудь
   аттрибута (например поле VERSION), и если оно изменилось то транзакция откатывается (или проблема коллизии как-то решается)
2) Пессимистическая
   перед изменение данных, все строки в которых ожидается изменение блокируются
   такая блокировка исключает изменение из сторонних сессий
   бывает двух типов:
   2.1) shared (read) - блокирует писателей, но позволяет читать
   2.2) exclusive (write) - блокирует и писателей и читателей

Основная разница:
Оптимистическая блокировка накладывает доп расходы только в случае конфликта, а пессимистическая блокировка уменьшает
накладные расходы на конфликт. Отсюда вывод: оптимистическая блокировка подходит когда большинство транзакций
не конфликтуют между собой

